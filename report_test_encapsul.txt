============================= test session starts ==============================
platform linux -- Python 3.9.15, pytest-8.3.3, pluggy-1.5.0
benchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: /app
configfile: pytest.ini
testpaths: tests
plugins: anyio-4.6.2.post1, benchmark-4.0.0
collected 16 items

tests/test_benchmark.py::test_predict_latency 
-------------------------------- live log call ---------------------------------
INFO     uvicorn:tf_app.py:68 Prediction took 1.1756 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1046 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1065 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1017 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1047 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1042 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1023 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
PASSED                                                                   [  6%]
tests/test_benchmark.py::test_predict_load[short_text_positive] 
-------------------------------- live log call ---------------------------------
INFO     uvicorn:tf_app.py:68 Prediction took 0.1080 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1044 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1013 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1007 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1015 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1016 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1046 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1026 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1015 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1014 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
PASSED                                                                   [ 12%]
tests/test_benchmark.py::test_predict_load[short_text_negative] 
-------------------------------- live log call ---------------------------------
INFO     uvicorn:tf_app.py:68 Prediction took 0.1011 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1029 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1064 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1086 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1048 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1081 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1058 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1047 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1109 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1079 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
PASSED                                                                   [ 18%]
tests/test_benchmark.py::test_predict_load[long_text_positive] 
-------------------------------- live log call ---------------------------------
INFO     uvicorn:tf_app.py:68 Prediction took 0.1093 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1086 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1065 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1038 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1060 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1023 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1043 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1029 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1020 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1018 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
PASSED                                                                   [ 25%]
tests/test_benchmark.py::test_predict_load[short_text_neutral] 
-------------------------------- live log call ---------------------------------
INFO     uvicorn:tf_app.py:68 Prediction took 0.1034 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1033 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1029 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1039 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1007 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1020 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1056 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1028 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1045 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
INFO     uvicorn:tf_app.py:68 Prediction took 0.1042 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
PASSED                                                                   [ 31%]
tests/test_integration.py::test_root_endpoint 
-------------------------------- live log call ---------------------------------
INFO     httpx:_client.py:1038 HTTP Request: GET http://testserver/ "HTTP/1.1 200 OK"
PASSED                                                                   [ 37%]
tests/test_integration.py::test_predict_empty_text 
-------------------------------- live log call ---------------------------------
INFO     uvicorn:tf_app.py:68 Prediction took 0.1020 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
PASSED                                                                   [ 43%]
tests/test_integration.py::test_predict_endpoint[I love this!-positive-love] 
-------------------------------- live log call ---------------------------------
INFO     uvicorn:tf_app.py:68 Prediction took 0.1020 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
PASSED                                                                   [ 50%]
tests/test_integration.py::test_predict_endpoint[This is terrible.-negative-terrible] 
-------------------------------- live log call ---------------------------------
INFO     uvicorn:tf_app.py:68 Prediction took 0.1067 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
PASSED                                                                   [ 56%]
tests/test_integration.py::test_predict_endpoint[It's okay, nothing special.-neutral-okay] 
-------------------------------- live log call ---------------------------------
INFO     uvicorn:tf_app.py:68 Prediction took 0.1031 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
PASSED                                                                   [ 62%]
tests/test_integration.py::test_predict_endpoint[-positive-] 
-------------------------------- live log call ---------------------------------
INFO     uvicorn:tf_app.py:68 Prediction took 0.1000 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
PASSED                                                                   [ 68%]
tests/test_integration.py::test_predict_endpoint[Great quality, amazing product.-invalid_sentiment-Great quality, amazing product.] 
-------------------------------- live log call ---------------------------------
INFO     uvicorn:tf_app.py:68 Prediction took 0.1011 seconds
INFO     httpx:_client.py:1038 HTTP Request: POST http://testserver/predict "HTTP/1.1 200 OK"
PASSED                                                                   [ 75%]
tests/test_tensorflow.py::test_model_loading PASSED                      [ 81%]
tests/test_tensorflow.py::test_tensorflow_predict PASSED                 [ 87%]
tests/test_triton.py::test_triton_preprocessing SKIPPED (Only for Tr...) [ 93%]
tests/test_triton.py::test_triton_predict_endpoint SKIPPED (Only for...) [100%]


--------------------------------------------------------------------------------------- benchmark 'load_test': 4 tests --------------------------------------------------------------------------------------
Name (time in ms)                               Min                 Max                Mean            StdDev              Median               IQR            Outliers     OPS            Rounds  Iterations
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_predict_load[short_text_positive]     103.0605 (1.0)      110.8668 (1.02)     105.5292 (1.0)      2.3314 (1.83)     104.4641 (1.0)      3.0420 (2.01)          2;0  9.4760 (1.0)          10           1
test_predict_load[short_text_negative]     103.9103 (1.01)     113.9794 (1.05)     109.0029 (1.03)     2.9316 (2.31)     108.8703 (1.04)     3.6743 (2.43)          3;0  9.1741 (0.97)         10           1
test_predict_load[short_text_neutral]      103.9848 (1.01)     108.4769 (1.0)      106.2097 (1.01)     1.2714 (1.0)      106.3390 (1.02)     1.5136 (1.0)           3;0  9.4153 (0.99)         10           1
test_predict_load[long_text_positive]      104.3495 (1.01)     112.6546 (1.04)     107.5917 (1.02)     2.9677 (2.33)     106.9783 (1.02)     4.1420 (2.74)          4;0  9.2944 (0.98)         10           1
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

---------------------------------------- benchmark 'predict_latency': 1 tests ---------------------------------------
Name (time in ms)             Min       Max      Mean  StdDev    Median     IQR  Outliers     OPS  Rounds  Iterations
---------------------------------------------------------------------------------------------------------------------
test_predict_latency     104.7778  108.8165  107.1447  1.5204  107.6812  1.7956       2;0  9.3332       5           1
---------------------------------------------------------------------------------------------------------------------

Legend:
  Outliers: 1 Standard Deviation from Mean; 1.5 IQR (InterQuartile Range) from 1st Quartile and 3rd Quartile.
  OPS: Operations Per Second, computed as 1 / Mean
================== 14 passed, 2 skipped, 2 warnings in 16.66s ==================
